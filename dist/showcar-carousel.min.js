"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function addClass(t,e){if(!e.getAttribute)return e;var i=[],n=e.getAttribute("class");return n?(i=n.split(" "),i.indexOf(t)===-1&&(n=i.concat(t).join(" "))):n=t,e.setAttribute("class",n),e}function removeClass(t,e){if(!e.getAttribute)return e;var i=[],n=e.getAttribute("class");return n&&(i=n.split(" "),i.indexOf(t)!==-1&&i.splice(i.indexOf(t),1),e.setAttribute("class",i.join(" "))),e}function containsClass(t,e){if(!e.getAttribute)return!1;var i=[],n=e.getAttribute("class");return n&&(i=n.split(" ")),i.indexOf(t)>-1}function elementCreatedHandler(){var t=parseInt(checkValue(this.getAttribute("gap"),20));this.carousel=new Carousel(this,{gap:t})}function elementAttachedHandler(){this.carousel.attached()}function elementDetachedCallback(){this.carousel.detached(),delete this.carousel}function elementAttributeChangedHandler(t){"gap"===t&&(this.carousel.config.gap=parseInt(checkValue(this.getAttribute("gap"),20)))}function checkValue(t,e){return"undefined"!=typeof t&&null!==t?t:e}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}();var Carousel=function(){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{gap:20}:arguments[1];_classCallCheck(this,t),this.config=i,this.element=e,this.container=null,this.resizeTimeout=null,this.resizeListener=null,this.touchStartListener=null,this.touchMoveListener=null,this.touchEndListener=null,this.pagination={left:null,right:null},this.index=0,this.refWidth=330,this.itemWidth=330,this.touchStart={},this.speed=t.Speed.SLOW,this.pager=document.createElement("a"),addClass("as24-pagination",this.pager),addClass("hide",this.pager),this.pager.href="#"}return _createClass(t,[{key:"attached",value:function(){this.windowWidth=this.getWindowWidth(),this.resizeListener=this.resizeTimeoutHandler.bind(this),this.touchStartListener=this.touchStartEventHandler.bind(this),this.touchMoveListener=this.touchMoveEventHandler.bind(this),this.touchEndListener=this.touchEndEventHandler.bind(this),window.addEventListener("resize",this.resizeListener,!0),this.element.addEventListener("touchstart",this.touchStartListener,!0),this.element.addEventListener("touchmove",this.touchMoveListener,!0),this.element.addEventListener("touchend",this.touchEndListener,!0),this.addContainer(),this.resizeItems(),this.addPagination(),this.calculateEnvironment(),this.loadImages()}},{key:"detached",value:function(){window.removeEventListener("resize",this.resizeListener,!0),this.element.removeEventListener("touchstart",this.touchStartListener,!0),this.element.removeEventListener("touchmove",this.touchMoveListener,!0),this.element.removeEventListener("touchend",this.touchEndListener,!0),this.removeContainer(),this.removePagination()}},{key:"redraw",value:function(){this.index=0,this.resizeItems(),this.calculateEnvironment(),this.setPaginationButtonsVisibility(),this.loadImages(),this.moveContainer(0)}},{key:"resizeItems",value:function(){var t=this;this.orgWidth=this.items[0].getBoundingClientRect().width+this.config.gap,this.orgWidth===this.refWidth&&this.element.offsetWidth<this.refWidth?(this.itemWidth=this.element.offsetWidth-this.config.gap,[].forEach.call(this.items,function(e){return e.style.width=t.itemWidth-t.config.gap+"px"})):this.itemWidth=this.items[0].getBoundingClientRect().width+this.config.gap}},{key:"touchStartEventHandler",value:function(t){var e=t.target;this.resetTouch(),containsClass("as24-pagination",e)||(this.touchStart=this.getTouchCoords(t))}},{key:"touchMoveEventHandler",value:function(t){if(this.isSwiping()){var e=this.getTouchCoords(t),i=Math.abs(e.x-this.touchStart.x),n=Math.abs(e.y-this.touchStart.y);i<n?this.resetTouch():t.preventDefault()}}},{key:"touchEndEventHandler",value:function(e){if(this.isSwiping())for(var i=this.getTouchCoords(e.changedTouches[0]),n=this.touchStart.x-i.x,s=Math.abs(n),a=Math.ceil(s/this.itemWidth),r=0;r<a;r++)n>0?this.paginate(t.Direction.RIGHT):n<0&&this.paginate(t.Direction.LEFT)}},{key:"getTouchCoords",value:function(e){var i=e.touches&&e.touches[0];return new t.Coordinate(e.clientX||i&&i.clientX,e.clientY||i&&i.clientY)}},{key:"resetTouch",value:function(){this.touchStart={}}},{key:"isSwiping",value:function(){return Object.keys(this.touchStart).length>0}},{key:"calculateEnvironment",value:function(){this.itemsLength=this.container.children.length,this.itemsVisible=Math.floor(this.element.offsetWidth/this.itemWidth),this.totalReach=this.container.offsetWidth-this.element.offsetWidth,this.stepLength=this.speed===t.Speed.SLOW?this.itemsLength-this.itemsVisible:Math.ceil(this.itemsLength/this.itemsVisible),this.stepWidth=this.speed===t.Speed.SLOW?this.itemWidth:Math.floor(this.element.offsetWidth/this.itemWidth)*this.itemWidth}},{key:"getNewIndex",value:function(e){e===t.Direction.LEFT&&this.index>0?this.index-=1:e===t.Direction.RIGHT&&this.index<this.stepLength&&(this.index+=1)}},{key:"addContainer",value:function(){var t=this;return containsClass("as24-carousel-wrapper",this.element.firstChild)?(this.wrapper=this.element.querySelector(".as24-carousel-wrapper"),void(this.container=this.element.querySelector(".as24-carousel-container"))):(this.wrapper=document.createElement("div"),addClass("as24-carousel-wrapper",this.wrapper),this.container=document.createElement("div"),addClass("as24-carousel-container",this.container),[].forEach.call(this.element.children,function(e){var i=e.cloneNode(!0);t.container.appendChild(i)}),this.wrapper.appendChild(this.container),this.element.innerHTML="",void this.element.appendChild(this.wrapper))}},{key:"removeContainer",value:function(){var t=this;[].forEach.call(this.container.children,function(e){t.container.removeChild(e)}),this.wrapper.removeChild(this.container),this.element.removeChild(this.wrapper)}},{key:"addPagination",value:function(){this.removePagination();for(var e=[t.Direction.LEFT,t.Direction.RIGHT],i=0;i<e.length;i++){var n=e[i];this.createPaginationButton(n)}removeClass("hide",this.pagination.right)}},{key:"removePagination",value:function(){var t=this.element.querySelectorAll("[data-direction]");[].forEach.call(t,function(t){t.parentNode.removeChild(t)})}},{key:"createPaginationButton",value:function(t){var e=this,i=this.pagination[t]=this.pager.cloneNode(!0);i.setAttribute("data-direction",t),i.addEventListener("mouseup",function(i){i.stopPropagation(),i.preventDefault(),e.paginate(t)}),i.addEventListener("click",function(t){return t.preventDefault()}),this.element.appendChild(i)}},{key:"goTo",value:function(t){this.index=t,this.triggerEvent("slide",{index:this.index}),this.update()}},{key:"paginate",value:function(t){this.getNewIndex(t),this.triggerEvent("slide",{direction:t,index:this.index}),this.update()}},{key:"update",value:function(){var t=this.calculateDistance();this.setPaginationButtonsVisibility(),this.loadImages(),this.moveContainer(t)}},{key:"calculateDistance",value:function(){var t=this.index*this.stepWidth;return t=t>this.totalReach?this.totalReach:t,~t+1}},{key:"moveContainer",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0];this.container.style.transform="translate3d("+t+"px, 0, 0)",this.container.style.webkitTransform="translate3d("+t+"px, 0, 0)"}},{key:"setPaginationButtonsVisibility",value:function(){0===this.index?addClass("hide",this.pagination.left):removeClass("hide",this.pagination.left),this.index===this.stepLength?addClass("hide",this.pagination.right):removeClass("hide",this.pagination.right)}},{key:"loadImages",value:function(){var e=this.index,i=Math.ceil(this.element.offsetWidth/this.itemWidth),n=this.speed===t.Speed.SLOW?this.index+i:(this.index+1)*i;n=n>this.itemsLength?this.itemsLength:n;for(var s=e;s<n;s++){var a=this.container.children[s].querySelectorAll("img");[].forEach.call(a,function(t){var e=t.getAttribute("data-src");null!==e&&(t.setAttribute("src",e),t.removeAttribute("data-src"))})}}},{key:"triggerEvent",value:function(t,e){var i=new CustomEvent(t,{detail:e});this.element.dispatchEvent(i)}},{key:"resizeHandler",value:function(){var t=this.getWindowWidth();this.windowWidth!==t&&(this.windowWidth=t,this.redraw())}},{key:"resizeTimeoutHandler",value:function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(this.resizeHandler.bind(this),300)}},{key:"getWindowWidth",value:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}},{key:"items",get:function(){return this.element.querySelectorAll("as24-carousel-item")}}]),t}();Carousel.Direction={LEFT:"left",RIGHT:"right"},Carousel.Speed={SLOW:"slow",FAST:"fast"},Carousel.Coordinate=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{x:t,y:e}};try{document.registerElement("as24-carousel",{prototype:Object.assign(Object.create(HTMLElement.prototype,{createdCallback:{value:elementCreatedHandler},attachedCallback:{value:elementAttachedHandler},detachedCallback:{value:elementDetachedCallback},attributeChangedCallback:{value:elementAttributeChangedHandler}}),{redraw:function(){this.carousel.redraw()},goTo:function(t){this.carousel.goTo(t)},getIndex:function(){return this.carousel.index}})})}catch(e){window&&window.console&&window.console.warn('Failed to register CustomElement "as24-carousel".',e)}
//# sourceMappingURL=dist/showcar-carousel.min.js.map