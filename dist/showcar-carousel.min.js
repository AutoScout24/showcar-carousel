"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function addClass(t,e){var i=[],n=e.getAttribute("class");return n?(i=n.split(" "),-1===i.indexOf(t)&&(n=i.concat(t).join(" "))):n=t,e.setAttribute("class",n),e}function removeClass(t,e){var i=[],n=e.getAttribute("class");return n&&(i=n.split(" "),-1!==i.indexOf(t)&&i.splice(i.indexOf(t),1),e.setAttribute("class",i.join(" "))),e}function containsClass(t,e){var i=[],n=e.getAttribute("class");return n&&(i=n.split(" ")),i.indexOf(t)>-1}function getWindowWidth(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}function resizeHandler(){var t=getWindowWidth();this.windowWidth!==t&&(this.windowWidth=t,this.carousel.redraw())}function elementCreatedHandler(){this.carousel=new Carousel(this)}function elementAttachedHandler(){var t=this;this.carousel.init(),this.windowWidth=getWindowWidth(),window.addEventListener("resize",function(){clearTimeout(resizeHandler),setTimeout(resizeHandler.bind(t),300)})}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),Carousel=function(){function t(e){_classCallCheck(this,t),this.element=e,this.container=null,this.pagination={left:null,right:null},this.index=0,this.refWidth=330,this.itemWidth=330,this.touchStart={},this.touchPrev={},this.speed=t.Speed.SLOW,this.pager=document.createElement("a"),addClass("as24-pagination",this.pager),addClass("hide",this.pager),this.pager.href="#",this.element.addEventListener("touchstart",this.touchStartEventHandler.bind(this)),this.element.addEventListener("touchmove",this.touchMoveEventHandler.bind(this)),this.element.addEventListener("touchend",this.touchEndEventHandler.bind(this))}return _createClass(t,[{key:"init",value:function(){this.addContainer(),this.resizeItems(),this.addPagination(),this.calculateEnvironment(),this.loadImages()}},{key:"redraw",value:function(){this.index=0,this.resizeItems(),this.calculateEnvironment(),this.setPaginationButtonsVisibility(),this.loadImages(),this.moveContainer(0)}},{key:"resizeItems",value:function(){var t=this;this.orgWidth=this.items[0].getBoundingClientRect().width+20,this.orgWidth===this.refWidth&&this.element.offsetWidth<this.refWidth?(this.itemWidth=this.element.offsetWidth-20,[].forEach.call(this.items,function(e){return e.style.width=t.itemWidth-20+"px"})):this.itemWidth=this.items[0].getBoundingClientRect().width+20}},{key:"touchStartEventHandler",value:function(t){var e=t.target;this.resetTouch(),containsClass("as24-pagination",e)||(this.touchStart=this.getTouchCoords(t),this.touchPrev=this.touchStart)}},{key:"touchMoveEventHandler",value:function(t){if(this.isSwiping()){var e=this.getTouchCoords(t),i=Math.abs(e.x-this.touchStart.x),n=Math.abs(e.y-this.touchStart.y);n>i?this.resetTouch():(t.preventDefault(),this.touchPrev=e)}}},{key:"touchEndEventHandler",value:function(e){if(this.isSwiping())for(var i=this.getTouchCoords(e.changedTouches[0]),n=this.touchStart.x-i.x,s=Math.abs(n),a=Math.ceil(s/this.itemWidth),h=0;a>h;h++)n>0?this.paginate(t.Direction.RIGHT):0>n&&this.paginate(t.Direction.LEFT)}},{key:"getTouchCoords",value:function(e){var i=e.touches&&e.touches[0];return new t.Coordinate(e.clientX||i&&i.clientX,e.clientY||i&&i.clientY)}},{key:"resetTouch",value:function(){this.touchStart={},this.touchPrev={}}},{key:"isSwiping",value:function(){return Object.keys(this.touchStart).length>0}},{key:"calculateEnvironment",value:function(){this.itemsLength=this.container.children.length,this.itemsVisible=Math.floor(this.element.offsetWidth/this.itemWidth),this.totalReach=this.container.offsetWidth-this.element.offsetWidth,this.stepLength=this.speed===t.Speed.SLOW?this.itemsLength-this.itemsVisible:Math.ceil(this.itemsLength/this.itemsVisible),this.stepWidth=this.speed===t.Speed.SLOW?this.itemWidth:Math.floor(this.element.offsetWidth/this.itemWidth)*this.itemWidth}},{key:"getNewIndex",value:function(e){e===t.Direction.LEFT&&this.index>0?this.index-=1:e===t.Direction.RIGHT&&this.index<this.stepLength&&(this.index+=1)}},{key:"addContainer",value:function(){var t=this,e=document.createElement("div");addClass("as24-carousel-wrapper",e),this.container=document.createElement("div"),addClass("as24-carousel-container",this.container),[].forEach.call(this.element.children,function(e){var i=e.cloneNode(!0);t.container.appendChild(i)}),e.appendChild(this.container),this.element.innerHTML="",this.element.appendChild(e)}},{key:"addPagination",value:function(){for(var e=[t.Direction.LEFT,t.Direction.RIGHT],i=0;i<e.length;i++){var n=e[i];this.createPaginationButton(n)}removeClass("hide",this.pagination.right)}},{key:"createPaginationButton",value:function(t){var e=this,i=this.pagination[t]=this.pager.cloneNode(!0);i.setAttribute("data-direction",t),i.addEventListener("mouseup",function(i){i.stopPropagation(),i.preventDefault(),e.paginate(t)}),i.addEventListener("click",function(t){return t.preventDefault()}),this.element.appendChild(i)}},{key:"paginate",value:function(t){this.getNewIndex(t);var e=this.calculateDistance();this.setPaginationButtonsVisibility(),this.loadImages(),this.moveContainer(e)}},{key:"calculateDistance",value:function(){var t=this.index*this.stepWidth;return t=t>this.totalReach?this.totalReach:t,~t+1}},{key:"moveContainer",value:function(t){t=0|t,this.container.style.transform="translate3d("+t+"px, 0, 0)",this.container.style.webkitTransform="translate3d("+t+"px, 0, 0)"}},{key:"setPaginationButtonsVisibility",value:function(){0===this.index?addClass("hide",this.pagination.left):removeClass("hide",this.pagination.left),this.index===this.stepLength?addClass("hide",this.pagination.right):removeClass("hide",this.pagination.right)}},{key:"loadImages",value:function(){var e=this.index,i=Math.ceil(this.element.offsetWidth/this.itemWidth),n=this.speed===t.Speed.SLOW?this.index+i:(this.index+1)*i;n=n>this.itemsLength?this.itemsLength:n;for(var s=e;n>s;s++){var a=this.container.children[s].querySelectorAll("img");[].forEach.call(a,function(t){var e=t.getAttribute("data-src");null!==e&&(t.setAttribute("src",e),t.removeAttribute("data-src"))})}}},{key:"items",get:function(){return this.element.querySelectorAll("as24-carousel-item")}}]),t}();Carousel.Direction={LEFT:"left",RIGHT:"right"},Carousel.Speed={SLOW:"slow",FAST:"fast"},Carousel.Coordinate=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{x:t,y:e}};try{document.registerElement("as24-carousel",{prototype:Object.assign(Object.create(HTMLElement.prototype,{createdCallback:{value:elementCreatedHandler},attachedCallback:{value:elementAttachedHandler}}),{redraw:function(){this.carousel.redraw()}})})}catch(e){window&&window.console&&window.console.warn('Failed to register CustomElement "as24-carousel".',e)}
//# sourceMappingURL=./dist/showcar-carousel.min.js.map