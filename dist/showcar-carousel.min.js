"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function addClass(t,e){if(!e.getAttribute)return e;var i=[],n=e.getAttribute("class");return n?(i=n.split(" "),i.indexOf(t)===-1&&(n=i.concat(t).join(" "))):n=t,e.setAttribute("class",n),e}function removeClass(t,e){if(!e.getAttribute)return e;var i=[],n=e.getAttribute("class");return n&&(i=n.split(" "),i.indexOf(t)!==-1&&i.splice(i.indexOf(t),1),e.setAttribute("class",i.join(" "))),e}function containsClass(t,e){if(!e.getAttribute)return!1;var i=[],n=e.getAttribute("class");return n&&(i=n.split(" ")),i.indexOf(t)>-1}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}(),function(){Array.of||(Array.of=function(){return Array.prototype.slice.call(arguments)})}();var Carousel=function(){function t(e,i){_classCallCheck(this,t),this.config=i,this.element=e,this.container=null,this.resizeTimeout=null,this.resizeListener=null,this.touchStartListener=null,this.touchMoveListener=null,this.touchEndListener=null,this.Enums={Direction:{LEFT:"left",RIGHT:"right"},Speed:{SLOW:"slow",FAST:"fast"},Mode:{DEFAULT:"default",SLIDER:"slider"}},this.pagination={left:null,right:null,indicator:null},this.index=0,this.lastIndex=0,this.refWidth=330,this.itemWidth=330,this.touchStart={},this.itemsLength=1,this.speed=this.Enums.Speed.SLOW,this.time=null}return _createClass(t,[{key:"Coordinate",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{x:t,y:e}}},{key:"attached",value:function(){this.windowWidth=this.getWindowWidth(),this.resizeListener=this.resizeTimeoutHandler.bind(this),this.touchStartListener=this.touchStartEventHandler.bind(this),this.touchMoveListener=this.touchMoveEventHandler.bind(this),this.touchEndListener=this.touchEndEventHandler.bind(this),window.addEventListener("resize",this.resizeListener,!0),this.element.addEventListener("touchstart",this.touchStartListener,!0),this.element.addEventListener("touchmove",this.touchMoveListener,!0),this.element.addEventListener("touchend",this.touchEndListener,!0),this.addContainer(),this.addPagination(),this.addIndicator(),this.redraw()}},{key:"detached",value:function(){window.removeEventListener("resize",this.resizeListener,!0),this.element.removeEventListener("touchstart",this.touchStartListener,!0),this.element.removeEventListener("touchmove",this.touchMoveListener,!0),this.element.removeEventListener("touchend",this.touchEndListener,!0),this.removeContainer(),this.removePagination(),this.removeIndicator()}},{key:"redraw",value:function(){this.resizeItems(),this.calculateEnvironment(),this.config.mode===this.Enums.Mode.DEFAULT?(this.index=0,this.updateDefault()):this.config.mode===this.Enums.Mode.SLIDER&&this.updateSlider({transition:!1}),this.updateIndicator()}},{key:"resizeItems",value:function(){var t=this;this.config.mode===this.Enums.Mode.SLIDER&&this.config.preview&&this.getElementWidth()>this.config.previewBreakpoint?addClass("dynamic-ratio",this.element):removeClass("dynamic-ratio",this.element),this.orgWidth=this.items[0].getBoundingClientRect().width+this.config.gap,this.orgWidth===this.refWidth&&this.getElementWidth()<this.refWidth?(this.itemWidth=this.getElementWidth()-this.config.gap,[].forEach.call(this.items,function(e){return e.style.width=t.itemWidth-t.config.gap+"px"})):this.itemWidth=this.items[0].getBoundingClientRect().width+this.config.gap,this.config.mode===this.Enums.Mode.SLIDER&&!function(){var e=40,i=null;if(t.getElementWidth()>t.config.previewBreakpoint&&t.config.preview){var n=(t.getElementWidth()-t.itemWidth)/2;e=n>40?n:40,i=e+"px"}var s=t.element.querySelectorAll("[data-direction]");[].forEach.call(s,function(t){t.style.width=e+"px"}),t.config.indicator&&(t.pagination.indicator.style.left=i)}()}},{key:"touchStartEventHandler",value:function(t){var e=t.target;this.resetTouch(),containsClass("as24-pagination-button",e)||(this.touchStart=this.getTouchCoords(t))}},{key:"touchMoveEventHandler",value:function(t){if(this.isSwiping()){var e=this.getTouchCoords(t),i=Math.abs(e.x-this.touchStart.x),n=Math.abs(e.y-this.touchStart.y);i<n?this.resetTouch():t.preventDefault()}}},{key:"touchEndEventHandler",value:function(t){if(this.isSwiping())for(var e=this.getTouchCoords(t.changedTouches[0]),i=this.touchStart.x-e.x,n=Math.abs(i),s=Math.ceil(n/this.itemWidth),a=0;a<s;a++)i>0?this.paginate(this.Enums.Direction.RIGHT):i<0&&this.paginate(this.Enums.Direction.LEFT)}},{key:"getTouchCoords",value:function(t){var e=t.touches&&t.touches[0];return new this.Coordinate(t.clientX||e&&e.clientX,t.clientY||e&&e.clientY)}},{key:"resetTouch",value:function(){this.touchStart={}}},{key:"isSwiping",value:function(){return Object.keys(this.touchStart).length>0}},{key:"addContainer",value:function(){var t=this;return containsClass("as24-carousel-wrapper",this.element.firstChild)?(this.wrapper=this.element.querySelector(".as24-carousel-wrapper"),void(this.container=this.element.querySelector(".as24-carousel-container"))):(this.wrapper=document.createElement("div"),addClass("as24-carousel-wrapper",this.wrapper),this.container=document.createElement("div"),addClass("as24-carousel-container",this.container),[].forEach.call(this.element.children,function(e){var i=e.cloneNode(!0);t.container.appendChild(i)}),this.wrapper.appendChild(this.container),this.element.innerHTML="",void this.element.appendChild(this.wrapper))}},{key:"removeContainer",value:function(){var t=this;[].forEach.call(this.container.children,function(e){t.container.removeChild(e)}),this.wrapper.removeChild(this.container),this.element.removeChild(this.wrapper)}},{key:"addPagination",value:function(){this.removePagination();for(var t=[this.Enums.Direction.LEFT,this.Enums.Direction.RIGHT],e=0;e<t.length;e++){var i=t[e];this.createPaginationButton(i)}removeClass("hide",this.pagination.right),this.config.mode===this.Enums.Mode.SLIDER&&removeClass("hide",this.pagination.left)}},{key:"removePagination",value:function(){var t=this.element.querySelectorAll("[data-direction]");[].forEach.call(t,function(t){t.parentNode.removeChild(t)})}},{key:"addIndicator",value:function(){this.removeIndicator(),this.config.indicator&&(this.pagination.indicator=document.createElement("div"),addClass("as24-pagination-indicator",this.pagination.indicator),this.element.appendChild(this.pagination.indicator),this.updateIndicator())}},{key:"removeIndicator",value:function(){var t=this.element.querySelector(".as24-pagination-indicator");null!==t&&this.element.removeChild(t)}},{key:"createPaginationButton",value:function(t){var e=this,i=this.pagination[t]=document.createElement("a");addClass("as24-pagination-button",i),addClass("hide",i),i.href="#",i.setAttribute("data-direction",t),i.addEventListener("mouseup",function(i){i.stopPropagation(),i.preventDefault(),e.paginate(t)}),i.addEventListener("click",function(t){return t.preventDefault()}),this.element.appendChild(i)}},{key:"goTo",value:function(t){this.lastIndex=parseInt(this.index),t<0&&(t=0),this.index=t,this.triggerEvent("slide",{index:this.index}),this.update({transition:!1})}},{key:"paginate",value:function(t){this.lastIndex=parseInt(this.index),this.index=this.getIndexOf(this.index,t),this.triggerEvent("slide",{direction:t,index:this.index}),this.update({direction:t})}},{key:"calculateEnvironment",value:function(){this.itemsLength=this.container.children.length,this.itemsVisible=Math.floor(this.getElementWidth()/this.itemWidth),this.totalReach=this.container.offsetWidth-this.getElementWidth(),this.stepLength=this.speed===this.Enums.Speed.SLOW?this.itemsLength-this.itemsVisible:Math.ceil(this.itemsLength/this.itemsVisible),this.config.mode===this.Enums.Mode.SLIDER&&(this.stepLength=this.container.children.length-1),this.stepWidth=this.speed===this.Enums.Speed.SLOW?this.itemWidth:Math.floor(this.getElementWidth()/this.itemWidth)*this.itemWidth}},{key:"getIndexOf",value:function(t,e){var i=parseInt(t);return e===this.Enums.Direction.LEFT?i>0?i-1:this.config.mode===this.Enums.Mode.SLIDER?this.stepLength:0:e===this.Enums.Direction.RIGHT?i<this.stepLength?i+1:this.config.mode===this.Enums.Mode.SLIDER?0:this.stepLength:void 0}},{key:"update",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{direction:this.Enums.Direction.RIGHT,transition:!0}:arguments[0];this.triggerEvent("as24-carousel:change",{detail:{id:this.element.id}},window.document),this.updateIndicator(),this.config.mode===this.Enums.Mode.DEFAULT?this.updateDefault():this.config.mode===this.Enums.Mode.SLIDER&&this.lastIndex!==this.index&&this.updateSlider(t)}},{key:"updateDefault",value:function(){var t=this.index*this.stepWidth;t=t>this.totalReach?this.totalReach:t,t=~t+1,t=this.stepLength>0?t:0;var e=[],i=this.index,n=Math.ceil(this.getElementWidth()/this.itemWidth),s=this.speed===this.Enums.Speed.SLOW?this.index+n:(this.index+1)*n;s=s>this.itemsLength?this.itemsLength:s;for(var a=i;a<s;a++)e.push(a);this.loadImages(e),this.setPaginationButtonsVisibility(),this.move(t,this.container)}},{key:"updateSlider",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{direction:this.Enums.Direction.RIGHT,transition:!0}:arguments[0],i=e.direction,n=e.transition,s=void 0===n||n,a=this.Enums.Direction.LEFT,o=this.Enums.Direction.RIGHT,r=this.getElementWidth()>this.config.previewBreakpoint&&this.config.preview?2:1,h=this.config.preview?(this.getElementWidth()-this.itemWidth)/2:0,d=this.items[this.index],l=this.endTime();this.startTime();var c=l>300?300:0;[].forEach.call(this.items,function(t){addClass("no-transition",t),t.style.transitionDuration=c+"ms"}),s&&removeClass("no-transition",d),this.move(h,d);var u=this.positionItems({current:this.index,side:a,direction:i,previewSize:r,transition:s,offset:h}),m=this.positionItems({current:this.index,side:o,direction:i,previewSize:r,transition:s,offset:h}),v=[this.index],f=[].concat(u,v,m);return[].forEach.call(this.items,function(e,i){f.indexOf(i)===-1&&t.move(t.getElementWidth(),t.items[i])}),this.loadImages(f),f}},{key:"positionItems",value:function(){for(var t=arguments.length<=0||void 0===arguments[0]?{previewSize:2,transition:!0}:arguments[0],e=[],i=t.current,n=t.side,s=t.direction,a=t.previewSize,o=t.transition,r=t.offset,h=this.Enums.Direction.LEFT,d=this.Enums.Direction.RIGHT,l=parseInt(i),c=n===h?d:h,u=1;u<=a;u++){l=this.getIndexOf(l,n),e.push(l),(u<a||u===a&&s===c)&&o&&removeClass("no-transition",this.items[l]);var m=this.itemWidth*u;m=n===d?r+m:r-m,this.move(m,this.items[l])}return e}},{key:"updateIndicator",value:function(){null!==this.pagination.indicator&&(this.pagination.indicator.innerHTML=this.index+1+"/"+this.itemsLength)}},{key:"move",value:function(t,e){e.style.transform="translate3d("+t+"px, 0, 0)",e.style.webkitTransform="translate3d("+t+"px, 0, 0)"}},{key:"setPaginationButtonsVisibility",value:function(){0===this.index?addClass("hide",this.pagination.left):removeClass("hide",this.pagination.left),this.index===this.stepLength||this.stepLength<=0?addClass("hide",this.pagination.right):removeClass("hide",this.pagination.right)}},{key:"loadImages",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];[].forEach.call(e,function(e){var i=t.container.children[e].querySelectorAll("img");[].forEach.call(i,function(t){var e=t.getAttribute("data-src");null!==e&&(t.setAttribute("src",e),t.removeAttribute("data-src"))})})}},{key:"triggerEvent",value:function(t,e){var i=arguments.length<=2||void 0===arguments[2]?this.element:arguments[2],n=new CustomEvent(t,{detail:e});i.dispatchEvent(n)}},{key:"resizeHandler",value:function(){var t=this.getWindowWidth();this.windowWidth!==t&&(this.windowWidth=t,this.redraw())}},{key:"resizeTimeoutHandler",value:function(){this.resizeHandler()}},{key:"getWindowWidth",value:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}},{key:"getElementWidth",value:function(){var t=getComputedStyle(this.element),e=this.element.offsetWidth;return e-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)}},{key:"startTime",value:function(){this.time=new Date}},{key:"endTime",value:function(){if(null!==this.time){var t=new Date;return t-this.time}return 300}},{key:"items",get:function(){return this.element.querySelectorAll(".as24-carousel-item")}}]),t}();!function(){var t=[{name:"gap",value:20,type:"Number"},{name:"mode",value:"default",type:"String"},{name:"preview",value:!0,type:"Boolean"},{name:"previewBreakpoint",value:640,type:"Number"},{name:"indicator",value:!1,type:"Boolean"}],e=function(){var e=this,i={};[].forEach.call(t,function(t){i[t.name]=a(e.getAttribute(t.name),t.value,t.type)}),this.carousel=new Carousel(this,i)},i=function(){this.carousel.attached()},n=function(){this.carousel.detached(),delete this.carousel},s=function(e){var i=this;[].forEach.call(t,function(t){t.name===e&&(i.carousel.config[t.name]=a(i.getAttribute(t.name),t.value,t.type))})},a=function(t,e){var i=arguments.length<=2||void 0===arguments[2]?"String":arguments[2];return"undefined"!==t&&null!==t?("Number"===i&&(t=parseInt(t)),"Boolean"===i&&(t="true"==t),t):e};try{document.registerElement("as24-carousel",{prototype:_extends(Object.create(HTMLElement.prototype,{createdCallback:{value:e},attachedCallback:{value:i},detachedCallback:{value:n},attributeChangedCallback:{value:s}}),{redraw:function(){this.carousel.redraw()},goTo:function(t){this.carousel.goTo(t)},getIndex:function(){return this.carousel.index},getStepLength:function(){return this.carousel.stepLength}})})}catch(o){window&&window.console&&window.console.warn('Failed to register CustomElement "as24-carousel".',o)}}();
//# sourceMappingURL=dist/showcar-carousel.min.js.map