"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function addClass(t,e){if(!e.getAttribute)return e;var i=[],n=e.getAttribute("class");return n?(i=n.split(" "),i.indexOf(t)===-1&&(n=i.concat(t).join(" "))):n=t,e.setAttribute("class",n),e}function removeClass(t,e){if(!e.getAttribute)return e;var i=[],n=e.getAttribute("class");return n&&(i=n.split(" "),i.indexOf(t)!==-1&&i.splice(i.indexOf(t),1),e.setAttribute("class",i.join(" "))),e}function containsClass(t,e){if(!e.getAttribute)return!1;var i=[],n=e.getAttribute("class");return n&&(i=n.split(" ")),i.indexOf(t)>-1}function elementCreatedHandler(){var t={},e=!0,i=!1,n=void 0;try{for(var s,a=Carousel.Attributes[Symbol.iterator]();!(e=(s=a.next()).done);e=!0){var r=s.value;t[r.name]=checkValue(this.getAttribute(r.name),r.value,r.type)}}catch(o){i=!0,n=o}finally{try{!e&&a["return"]&&a["return"]()}finally{if(i)throw n}}this.carousel=new Carousel(this,t)}function elementAttachedHandler(){this.carousel.attached()}function elementDetachedCallback(){this.carousel.detached(),delete this.carousel}function elementAttributeChangedHandler(t){if(Carousel.Attributes.hasOwnProperty(t)){var e=Carousel.Attributes[t];this.carousel.config[e.name]=checkValue(this.getAttribute(e.name),e.value,e.type)}}function checkValue(t,e){var i=arguments.length<=2||void 0===arguments[2]?"String":arguments[2];return"undefined"!==t&&null!==t?("Number"===i&&(t=parseInt(t)),t):e}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}();var Carousel=function(){function t(e,i){_classCallCheck(this,t),this.config=i,this.element=e,this.container=null,this.resizeTimeout=null,this.resizeListener=null,this.touchStartListener=null,this.touchMoveListener=null,this.touchEndListener=null,this.pagination={left:null,right:null},this.index=0,this.lastIndex=0,this.refWidth=330,this.itemWidth=330,this.touchStart={},this.speed=t.Speed.SLOW,this.pager=document.createElement("a"),addClass("as24-pagination",this.pager),addClass("hide",this.pager),this.pager.href="#"}return _createClass(t,[{key:"attached",value:function(){this.windowWidth=this.getWindowWidth(),this.resizeListener=this.resizeTimeoutHandler.bind(this),this.touchStartListener=this.touchStartEventHandler.bind(this),this.touchMoveListener=this.touchMoveEventHandler.bind(this),this.touchEndListener=this.touchEndEventHandler.bind(this),window.addEventListener("resize",this.resizeListener,!0),this.element.addEventListener("touchstart",this.touchStartListener,!0),this.element.addEventListener("touchmove",this.touchMoveListener,!0),this.element.addEventListener("touchend",this.touchEndListener,!0),this.addContainer(),this.resizeItems(),this.addPagination(),this.calculateEnvironment(),this.loadImages()}},{key:"detached",value:function(){window.removeEventListener("resize",this.resizeListener,!0),this.element.removeEventListener("touchstart",this.touchStartListener,!0),this.element.removeEventListener("touchmove",this.touchMoveListener,!0),this.element.removeEventListener("touchend",this.touchEndListener,!0),this.removeContainer(),this.removePagination()}},{key:"redraw",value:function(){var e=this;this.resizeItems(),this.calculateEnvironment(),this.config.mode===t.Mode.DEFAULT?(this.index=0,this.move(0,this.container),this.setPaginationButtonsVisibility()):this.config.mode===t.Mode.SLIDER&&[].forEach.call(this.items,function(t,i){i!==e.index&&(addClass("no-transition",t),e.move(parseInt(e.stepWidth),t),removeClass("no-transition",t))}),this.loadImages()}},{key:"resizeItems",value:function(){var t=this;this.orgWidth=this.items[0].getBoundingClientRect().width+this.config.gap,this.orgWidth===this.refWidth&&this.element.offsetWidth<this.refWidth?(this.itemWidth=this.element.offsetWidth-this.config.gap,[].forEach.call(this.items,function(e){return e.style.width=t.itemWidth-t.config.gap+"px"})):this.itemWidth=this.items[0].getBoundingClientRect().width+this.config.gap}},{key:"touchStartEventHandler",value:function(t){var e=t.target;this.resetTouch(),containsClass("as24-pagination",e)||(this.touchStart=this.getTouchCoords(t))}},{key:"touchMoveEventHandler",value:function(t){if(this.isSwiping()){var e=this.getTouchCoords(t),i=Math.abs(e.x-this.touchStart.x),n=Math.abs(e.y-this.touchStart.y);i<n?this.resetTouch():t.preventDefault()}}},{key:"touchEndEventHandler",value:function(e){if(this.isSwiping())for(var i=this.getTouchCoords(e.changedTouches[0]),n=this.touchStart.x-i.x,s=Math.abs(n),a=Math.ceil(s/this.itemWidth),r=0;r<a;r++)n>0?this.paginate(t.Direction.RIGHT):n<0&&this.paginate(t.Direction.LEFT)}},{key:"getTouchCoords",value:function(e){var i=e.touches&&e.touches[0];return new t.Coordinate(e.clientX||i&&i.clientX,e.clientY||i&&i.clientY)}},{key:"resetTouch",value:function(){this.touchStart={}}},{key:"isSwiping",value:function(){return Object.keys(this.touchStart).length>0}},{key:"addContainer",value:function(){var t=this;return containsClass("as24-carousel-wrapper",this.element.firstChild)?(this.wrapper=this.element.querySelector(".as24-carousel-wrapper"),void(this.container=this.element.querySelector(".as24-carousel-container"))):(this.wrapper=document.createElement("div"),addClass("as24-carousel-wrapper",this.wrapper),this.container=document.createElement("div"),addClass("as24-carousel-container",this.container),[].forEach.call(this.element.children,function(e){var i=e.cloneNode(!0);t.container.appendChild(i)}),this.wrapper.appendChild(this.container),this.element.innerHTML="",void this.element.appendChild(this.wrapper))}},{key:"removeContainer",value:function(){var t=this;[].forEach.call(this.container.children,function(e){t.container.removeChild(e)}),this.wrapper.removeChild(this.container),this.element.removeChild(this.wrapper)}},{key:"addPagination",value:function(){this.removePagination();for(var e=[t.Direction.LEFT,t.Direction.RIGHT],i=0;i<e.length;i++){var n=e[i];this.createPaginationButton(n)}removeClass("hide",this.pagination.right),this.config.mode===t.Mode.SLIDER&&removeClass("hide",this.pagination.left)}},{key:"removePagination",value:function(){var t=this.element.querySelectorAll("[data-direction]");[].forEach.call(t,function(t){t.parentNode.removeChild(t)})}},{key:"createPaginationButton",value:function(t){var e=this,i=this.pagination[t]=this.pager.cloneNode(!0);i.setAttribute("data-direction",t),i.addEventListener("mouseup",function(i){i.stopPropagation(),i.preventDefault(),e.paginate(t)}),i.addEventListener("click",function(t){return t.preventDefault()}),this.element.appendChild(i)}},{key:"goTo",value:function(e){this.lastIndex=parseInt(this.index),this.index=e,this.triggerEvent("slide",{index:this.index}),this.update(t.Direction.RIGHT)}},{key:"paginate",value:function(t){this.lastIndex=parseInt(this.index),this.index=this.getIndexOf(this.index,t),this.triggerEvent("slide",{direction:t,index:this.index}),this.update(t)}},{key:"calculateEnvironment",value:function(){this.itemsLength=this.container.children.length,this.itemsVisible=Math.floor(this.element.offsetWidth/this.itemWidth),this.totalReach=this.container.offsetWidth-this.element.offsetWidth,this.stepLength=this.speed===t.Speed.SLOW?this.itemsLength-this.itemsVisible:Math.ceil(this.itemsLength/this.itemsVisible),this.config.mode===t.Mode.SLIDER&&(this.stepLength=this.container.children.length-1),this.stepWidth=this.speed===t.Speed.SLOW?this.itemWidth:Math.floor(this.element.offsetWidth/this.itemWidth)*this.itemWidth}},{key:"getIndexOf",value:function(e,i){var n=parseInt(e);return i===t.Direction.LEFT?n>0?n-1:this.config.mode===t.Mode.SLIDER?this.stepLength:0:i===t.Direction.RIGHT?n<this.stepLength?n+1:this.config.mode===t.Mode.SLIDER?0:this.stepLength:void 0}},{key:"update",value:function(e){var i=this;if(this.triggerChange(),this.loadImages(),this.config.mode===t.Mode.DEFAULT){var n=this.index*this.stepWidth;n=n>this.totalReach?this.totalReach:n,n=~n+1,this.setPaginationButtonsVisibility(),this.move(n,this.container)}else this.config.mode===t.Mode.SLIDER&&this.lastIndex!==this.index&&!function(){var n=i.lastIndex,s=e===t.Direction.LEFT?"":"-",a=i.items[n],r=e===t.Direction.LEFT?"-":"",o=i.items[i.index];addClass("no-transition",o),addClass("no-transition",a),i.move(parseInt(r+i.stepWidth),o),setTimeout(function(){removeClass("no-transition",o),removeClass("no-transition",a),o.style.transform="translate3d(0px, 0, 0)",i.move(0,o),i.move(parseInt(s+i.stepWidth),a)},1)}()}},{key:"move",value:function(t,e){e.style.transform="translate3d("+t+"px, 0, 0)",e.style.webkitTransform="translate3d("+t+"px, 0, 0)"}},{key:"setPaginationButtonsVisibility",value:function(){0===this.index?addClass("hide",this.pagination.left):removeClass("hide",this.pagination.left),this.index===this.stepLength?addClass("hide",this.pagination.right):removeClass("hide",this.pagination.right)}},{key:"loadImages",value:function(){var e=[];if(this.config.mode===t.Mode.DEFAULT){var i=this.index,n=Math.ceil(this.element.offsetWidth/this.itemWidth),s=this.speed===t.Speed.SLOW?this.index+n:(this.index+1)*n;s=s>this.itemsLength?this.itemsLength:s;for(var a=i;a<s;a++)e.push(a)}else this.config.mode===t.Mode.SLIDER&&(e=Array.of(this.getIndexOf(this.index,t.Direction.LEFT),this.index,this.getIndexOf(this.index,t.Direction.RIGHT)));var r=!0,o=!1,h=void 0;try{for(var l,d=e[Symbol.iterator]();!(r=(l=d.next()).done);r=!0){var c=l.value,u=this.container.children[c].querySelectorAll("img");[].forEach.call(u,function(t){var e=t.getAttribute("data-src");null!==e&&(t.setAttribute("src",e),t.removeAttribute("data-src"))})}}catch(v){o=!0,h=v}finally{try{!r&&d["return"]&&d["return"]()}finally{if(o)throw h}}}},{key:"triggerEvent",value:function(t,e){var i=new CustomEvent(t,{detail:e});this.element.dispatchEvent(i)}},{key:"triggerChange",value:function(){var t=new CustomEvent("as24-carousel:change",{detail:{id:this.element.id}});window.document.dispatchEvent(t)}},{key:"resizeHandler",value:function(){var t=this.getWindowWidth();this.windowWidth!==t&&(this.windowWidth=t,this.redraw())}},{key:"resizeTimeoutHandler",value:function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(this.resizeHandler.bind(this),300)}},{key:"getWindowWidth",value:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}},{key:"items",get:function(){return this.element.querySelectorAll("as24-carousel-item")}}]),t}();Carousel.Direction={LEFT:"left",RIGHT:"right"},Carousel.Speed={SLOW:"slow",FAST:"fast"},Carousel.Mode={DEFAULT:"default",SLIDER:"slider"},Carousel.Coordinate=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{x:t,y:e}},Carousel.Attributes=[{name:"gap",value:20,type:"Number"},{name:"mode",value:Carousel.Mode.DEFAULT,type:"String"}];try{document.registerElement("as24-carousel",{prototype:Object.assign(Object.create(HTMLElement.prototype,{createdCallback:{value:elementCreatedHandler},attachedCallback:{value:elementAttachedHandler},detachedCallback:{value:elementDetachedCallback},attributeChangedCallback:{value:elementAttributeChangedHandler}}),{redraw:function(){this.carousel.redraw()},goTo:function(t){this.carousel.goTo(t)},getIndex:function(){return this.carousel.index}})})}catch(e){window&&window.console&&window.console.warn('Failed to register CustomElement "as24-carousel".',e)}
//# sourceMappingURL=dist/showcar-carousel.min.js.map