"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function addClass(t,e){if(!e.getAttribute)return e;var i=[],n=e.getAttribute("class");return n?(i=n.split(" "),i.indexOf(t)===-1&&(n=i.concat(t).join(" "))):n=t,e.setAttribute("class",n),e}function removeClass(t,e){if(!e.getAttribute)return e;var i=[],n=e.getAttribute("class");return n&&(i=n.split(" "),i.indexOf(t)!==-1&&i.splice(i.indexOf(t),1),e.setAttribute("class",i.join(" "))),e}function containsClass(t,e){if(!e.getAttribute)return!1;var i=[],n=e.getAttribute("class");return n&&(i=n.split(" ")),i.indexOf(t)>-1}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}(),function(){Array.of||(Array.of=function(){return Array.prototype.slice.call(arguments)})}();var Carousel=function(){function t(e,i){_classCallCheck(this,t),this.config=i,this.element=e,this.container=null,this.resizeTimeout=null,this.resizeListener=null,this.touchStartListener=null,this.touchMoveListener=null,this.touchEndListener=null,this.Enums={Direction:{LEFT:"left",RIGHT:"right"},Speed:{SLOW:"slow",FAST:"fast"},Mode:{DEFAULT:"default",SLIDER:"slider"}},this.pagination={left:null,right:null},this.index=0,this.lastIndex=0,this.refWidth=330,this.itemWidth=330,this.touchStart={},this.speed=this.Enums.Speed.SLOW,this.pager=document.createElement("a"),addClass("as24-pagination",this.pager),addClass("hide",this.pager),this.pager.href="#"}return _createClass(t,[{key:"Coordinate",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{x:t,y:e}}},{key:"attached",value:function(){this.windowWidth=this.getWindowWidth(),this.resizeListener=this.resizeTimeoutHandler.bind(this),this.touchStartListener=this.touchStartEventHandler.bind(this),this.touchMoveListener=this.touchMoveEventHandler.bind(this),this.touchEndListener=this.touchEndEventHandler.bind(this),window.addEventListener("resize",this.resizeListener,!0),this.element.addEventListener("touchstart",this.touchStartListener,!0),this.element.addEventListener("touchmove",this.touchMoveListener,!0),this.element.addEventListener("touchend",this.touchEndListener,!0),this.addContainer(),this.resizeItems(),this.addPagination(),this.calculateEnvironment(),this.loadImages()}},{key:"detached",value:function(){window.removeEventListener("resize",this.resizeListener,!0),this.element.removeEventListener("touchstart",this.touchStartListener,!0),this.element.removeEventListener("touchmove",this.touchMoveListener,!0),this.element.removeEventListener("touchend",this.touchEndListener,!0),this.removeContainer(),this.removePagination()}},{key:"redraw",value:function(){var t=this;this.resizeItems(),this.calculateEnvironment(),this.config.mode===this.Enums.Mode.DEFAULT?(this.index=0,this.move(0,this.container),this.setPaginationButtonsVisibility()):this.config.mode===this.Enums.Mode.SLIDER&&[].forEach.call(this.items,function(e,i){i!==t.index&&(addClass("no-transition",e),t.move(parseInt(t.stepWidth),e),removeClass("no-transition",e))}),this.loadImages()}},{key:"resizeItems",value:function(){var t=this;this.orgWidth=this.items[0].getBoundingClientRect().width+this.config.gap,this.orgWidth===this.refWidth&&this.element.offsetWidth<this.refWidth?(this.itemWidth=this.element.offsetWidth-this.config.gap,[].forEach.call(this.items,function(e){return e.style.width=t.itemWidth-t.config.gap+"px"})):this.itemWidth=this.items[0].getBoundingClientRect().width+this.config.gap}},{key:"touchStartEventHandler",value:function(t){var e=t.target;this.resetTouch(),containsClass("as24-pagination",e)||(this.touchStart=this.getTouchCoords(t))}},{key:"touchMoveEventHandler",value:function(t){if(this.isSwiping()){var e=this.getTouchCoords(t),i=Math.abs(e.x-this.touchStart.x),n=Math.abs(e.y-this.touchStart.y);i<n?this.resetTouch():t.preventDefault()}}},{key:"touchEndEventHandler",value:function(t){if(this.isSwiping())for(var e=this.getTouchCoords(t.changedTouches[0]),i=this.touchStart.x-e.x,n=Math.abs(i),s=Math.ceil(n/this.itemWidth),a=0;a<s;a++)i>0?this.paginate(this.Enums.Direction.RIGHT):i<0&&this.paginate(this.Enums.Direction.LEFT)}},{key:"getTouchCoords",value:function(t){var e=t.touches&&t.touches[0];return new this.Coordinate(t.clientX||e&&e.clientX,t.clientY||e&&e.clientY)}},{key:"resetTouch",value:function(){this.touchStart={}}},{key:"isSwiping",value:function(){return Object.keys(this.touchStart).length>0}},{key:"addContainer",value:function(){var t=this;return containsClass("as24-carousel-wrapper",this.element.firstChild)?(this.wrapper=this.element.querySelector(".as24-carousel-wrapper"),void(this.container=this.element.querySelector(".as24-carousel-container"))):(this.wrapper=document.createElement("div"),addClass("as24-carousel-wrapper",this.wrapper),this.container=document.createElement("div"),addClass("as24-carousel-container",this.container),[].forEach.call(this.element.children,function(e){var i=e.cloneNode(!0);t.container.appendChild(i)}),this.wrapper.appendChild(this.container),this.element.innerHTML="",void this.element.appendChild(this.wrapper))}},{key:"removeContainer",value:function(){var t=this;[].forEach.call(this.container.children,function(e){t.container.removeChild(e)}),this.wrapper.removeChild(this.container),this.element.removeChild(this.wrapper)}},{key:"addPagination",value:function(){this.removePagination();for(var t=[this.Enums.Direction.LEFT,this.Enums.Direction.RIGHT],e=0;e<t.length;e++){var i=t[e];this.createPaginationButton(i)}removeClass("hide",this.pagination.right),this.config.mode===this.Enums.Mode.SLIDER&&removeClass("hide",this.pagination.left)}},{key:"removePagination",value:function(){var t=this.element.querySelectorAll("[data-direction]");[].forEach.call(t,function(t){t.parentNode.removeChild(t)})}},{key:"createPaginationButton",value:function(t){var e=this,i=this.pagination[t]=this.pager.cloneNode(!0);i.setAttribute("data-direction",t),i.addEventListener("mouseup",function(i){i.stopPropagation(),i.preventDefault(),e.paginate(t)}),i.addEventListener("click",function(t){return t.preventDefault()}),this.element.appendChild(i)}},{key:"goTo",value:function(t){this.lastIndex=parseInt(this.index),this.index=t,this.triggerEvent("slide",{index:this.index}),this.update(this.Enums.Direction.RIGHT)}},{key:"paginate",value:function(t){this.lastIndex=parseInt(this.index),this.index=this.getIndexOf(this.index,t),this.triggerEvent("slide",{direction:t,index:this.index}),this.update(t)}},{key:"calculateEnvironment",value:function(){this.itemsLength=this.container.children.length,this.itemsVisible=Math.floor(this.element.offsetWidth/this.itemWidth),this.totalReach=this.container.offsetWidth-this.element.offsetWidth,this.stepLength=this.speed===this.Enums.Speed.SLOW?this.itemsLength-this.itemsVisible:Math.ceil(this.itemsLength/this.itemsVisible),this.config.mode===this.Enums.Mode.SLIDER&&(this.stepLength=this.container.children.length-1),this.stepWidth=this.speed===this.Enums.Speed.SLOW?this.itemWidth:Math.floor(this.element.offsetWidth/this.itemWidth)*this.itemWidth}},{key:"getIndexOf",value:function(t,e){var i=parseInt(t);return e===this.Enums.Direction.LEFT?i>0?i-1:this.config.mode===this.Enums.Mode.SLIDER?this.stepLength:0:e===this.Enums.Direction.RIGHT?i<this.stepLength?i+1:this.config.mode===this.Enums.Mode.SLIDER?0:this.stepLength:void 0}},{key:"update",value:function(t){var e=this;if(this.triggerChange(),this.loadImages(),this.config.mode===this.Enums.Mode.DEFAULT){var i=this.index*this.stepWidth;i=i>this.totalReach?this.totalReach:i,i=~i+1,this.setPaginationButtonsVisibility(),this.move(i,this.container)}else this.config.mode===this.Enums.Mode.SLIDER&&this.lastIndex!==this.index&&!function(){var i=e.lastIndex,n=t===e.Enums.Direction.LEFT?"":"-",s=e.items[i],a=t===e.Enums.Direction.LEFT?"-":"",o=e.items[e.index];addClass("no-transition",o),addClass("no-transition",s),e.move(parseInt(a+e.stepWidth),o),setTimeout(function(){removeClass("no-transition",o),removeClass("no-transition",s),o.style.transform="translate3d(0px, 0, 0)",e.move(0,o),e.move(parseInt(n+e.stepWidth),s)},1)}()}},{key:"move",value:function(t,e){e.style.transform="translate3d("+t+"px, 0, 0)",e.style.webkitTransform="translate3d("+t+"px, 0, 0)"}},{key:"setPaginationButtonsVisibility",value:function(){0===this.index?addClass("hide",this.pagination.left):removeClass("hide",this.pagination.left),this.index===this.stepLength?addClass("hide",this.pagination.right):removeClass("hide",this.pagination.right)}},{key:"loadImages",value:function(){var t=this,e=[];if(this.config.mode===this.Enums.Mode.DEFAULT){var i=this.index,n=Math.ceil(this.element.offsetWidth/this.itemWidth),s=this.speed===this.Enums.Speed.SLOW?this.index+n:(this.index+1)*n;s=s>this.itemsLength?this.itemsLength:s;for(var a=i;a<s;a++)e.push(a)}else this.config.mode===this.Enums.Mode.SLIDER&&(e=Array.of(this.getIndexOf(this.index,this.Enums.Direction.LEFT),this.index,this.getIndexOf(this.index,this.Enums.Direction.RIGHT)));[].forEach.call(e,function(e){var i=t.container.children[e].querySelectorAll("img");[].forEach.call(i,function(t){var e=t.getAttribute("data-src");null!==e&&(t.setAttribute("src",e),t.removeAttribute("data-src"))})})}},{key:"triggerEvent",value:function(t,e){var i=new CustomEvent(t,{detail:e});this.element.dispatchEvent(i)}},{key:"triggerChange",value:function(){var t=new CustomEvent("as24-carousel:change",{detail:{id:this.element.id}});window.document.dispatchEvent(t)}},{key:"resizeHandler",value:function(){var t=this.getWindowWidth();this.windowWidth!==t&&(this.windowWidth=t,this.redraw())}},{key:"resizeTimeoutHandler",value:function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(this.resizeHandler.bind(this),300)}},{key:"getWindowWidth",value:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}},{key:"items",get:function(){return this.element.querySelectorAll("as24-carousel-item")}}]),t}();!function(){var t=[{name:"gap",value:20,type:"Number"},{name:"mode",value:"default",type:"String"}],e=function(){var e=this,i={};[].forEach.call(t,function(t){i[t.name]=a(e.getAttribute(t.name),t.value,t.type)}),this.carousel=new Carousel(this,i)},i=function(){this.carousel.attached()},n=function(){this.carousel.detached(),delete this.carousel},s=function(e){if(t.hasOwnProperty(e)){var i=t[e];this.carousel.config[i.name]=a(this.getAttribute(i.name),i.value,i.type)}},a=function(t,e){var i=arguments.length<=2||void 0===arguments[2]?"String":arguments[2];return"undefined"!==t&&null!==t?("Number"===i&&(t=parseInt(t)),t):e};try{document.registerElement("as24-carousel",{prototype:_extends(Object.create(HTMLElement.prototype,{createdCallback:{value:e},attachedCallback:{value:i},detachedCallback:{value:n},attributeChangedCallback:{value:s}}),{redraw:function(){this.carousel.redraw()},goTo:function(t){this.carousel.goTo(t)},getIndex:function(){return this.carousel.index}})})}catch(o){window&&window.console&&window.console.warn('Failed to register CustomElement "as24-carousel".',o)}}();
//# sourceMappingURL=dist/showcar-carousel.min.js.map